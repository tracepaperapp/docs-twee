<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://tracepaper.draftsman.io/docs-twee/03_Utils/">
    <link rel="shortcut icon" href="https://tracepaper.draftsman.io/docs-twee/img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Globaly available concepts - Tracepaper</title>
    <link href="https://tracepaper.draftsman.io/docs-twee/css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="https://tracepaper.draftsman.io/docs-twee/css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="https://tracepaper.draftsman.io/docs-twee/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://tracepaper.draftsman.io/docs-twee/css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="https://tracepaper.draftsman.io/docs-twee/js/jquery-3.2.1.min.js"></script>
    <script src="https://tracepaper.draftsman.io/docs-twee/js/bootstrap-3.3.7.min.js"></script>
    <script src="https://tracepaper.draftsman.io/docs-twee/js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = 'https://tracepaper.draftsman.io/docs-twee';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Globaly available concepts", url: "#_top", children: [
              {title: "Expressions", url: "#expressions" },
              {title: "Dependencies", url: "#dependencies" },
              {title: "Patterns", url: "#patterns" },
              {title: "Roles", url: "#roles" },
              {title: "Python modules", url: "#python-modules" },
          ]},
        ];

    </script>
    <script src="https://tracepaper.draftsman.io/docs-twee/js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="01_expressions/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="01_expressions/" class="btn btn-xs btn-link">
        Expressions
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../02_View_Domain/02_projections/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../02_View_Domain/02_projections/" class="btn btn-xs btn-link">
        Projections
      </a>
    </div>
    
  </div>

    

    <h1 id="globaly-available-concepts">Globaly available concepts<a class="headerlink" href="#globaly-available-concepts" title="Permanent link">#</a></h1>
<p>Utils are globally available concepts that are modeled once and used across the system. They include:</p>
<h2 id="expressions">Expressions<a class="headerlink" href="#expressions" title="Permanent link">#</a></h2>
<p>Expressions are reusable logical constructs used to transform data on-the-fly before executing logic. There are two
types of expressions:</p>
<h3 id="api-authorization-expression">API Authorization Expression<a class="headerlink" href="#api-authorization-expression" title="Permanent link">#</a></h3>
<p>These expressions are used in models that define an access path in the GraphQL API. They
convert query variables to specific roles, useful in multi-tenant systems where each tenant has a private set of roles.</p>
<h3 id="trigger-key-expression">Trigger Key Expression<a class="headerlink" href="#trigger-key-expression" title="Permanent link">#</a></h3>
<p>The key expression is usable in all identity-based triggers: Aggregate behavior flows &amp; View data sources.
It is used to convert an event attribute into a functional key.</p>
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">#</a></h2>
<p>Allows you to add <a href="https://pypi.org/">pip packages</a> to you runtime, the package will be available for importing in
all custom python code in your project.</p>
<h2 id="patterns">Patterns<a class="headerlink" href="#patterns" title="Permanent link">#</a></h2>
<p>Patterns are <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions</a> that can be used while modelling 
commands to ensure a specific pattern for String fields e.g.</p>
<h3 id="lowercasedonly">LowercasedOnly<a class="headerlink" href="#lowercasedonly" title="Permanent link">#</a></h3>
<pre><code class="language-regexp">^[a-z]+$
</code></pre>
<h3 id="date">Date<a class="headerlink" href="#date" title="Permanent link">#</a></h3>
<pre><code class="language-regexp">^(?:20)\d{2}-\d{2}-\d{2}$
</code></pre>
<h3 id="extending-patters">Extending patters<a class="headerlink" href="#extending-patters" title="Permanent link">#</a></h3>
<p>Patterns may reference each-other e.g.</p>
<pre><code class="language-regexp">^{{LowercasedOnly}}:arn:{{LowercasedOnly}}$
</code></pre>
<h2 id="roles">Roles<a class="headerlink" href="#roles" title="Permanent link">#</a></h2>
<p>Simply a list of role names available in the modeler, at this moment these roles are not automatically loaded into the
the IAM system by Draftsman. The application owner needs to define these roles manually, or model an automation (@afterDeployment)
that creates these roles.</p>
<h2 id="python-modules">Python modules<a class="headerlink" href="#python-modules" title="Permanent link">#</a></h2>
<p>Python modules are usable scripts that define methods that are accessible from:</p>
<ul>
<li>Behavior flows</li>
<li>Automations</li>
</ul>
<pre><code class="language-python">def behavior_or_notifier_function(flow):
    # May set a flow variable
    flow.myVariable = &quot;Hello World!&quot;

    # And has access to flow variables
    print(flow.myVariable)

    # And has also access to the aggregate document
    print(flow.entity)
    print(flow.entity.entityField)
</code></pre>
<p>It is a simple function but it does provide you access to all variables available to the flow execution.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="01_expressions/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="01_expressions/" class="btn btn-xs btn-link">
        Expressions
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../02_View_Domain/02_projections/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../02_View_Domain/02_projections/" class="btn btn-xs btn-link">
        Projections
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>